<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Process</title><link href="http://changy-.github.io/" rel="alternate"></link><link href="http://changy-.github.io/feeds/os.atom.xml" rel="self"></link><id>http://changy-.github.io/</id><updated>2015-12-26T10:57:00-05:00</updated><entry><title>中断 &amp;&amp; 异常 &amp;&amp; 系统调用</title><link href="http://changy-.github.io/articles/zhong-duan-yi-chang-xi-tong-diao-yong.html" rel="alternate"></link><updated>2015-12-26T10:57:00-05:00</updated><author><name>Changy</name></author><id>tag:changy-.github.io,2015-12-26:articles/zhong-duan-yi-chang-xi-tong-diao-yong.html</id><summary type="html">&lt;h1&gt;中断 &amp;amp;&amp;amp; 异常 &amp;amp;&amp;amp; 系统调用&lt;/h1&gt;
&lt;h3&gt;基本概念&lt;/h3&gt;
&lt;p&gt;操作系统需要两种CPU状态:
 内核态(Kernel Mode)：运行操作系统程序
 用户态(User Mode)：运行用户程序&lt;/p&gt;
&lt;p&gt;用户态 → 内核态
- 唯一途径 → 中断/异常/陷入机制&lt;/p&gt;
&lt;p&gt;内核态 → 用户态
- 设置程序状态字PSW&lt;/p&gt;
&lt;p&gt;系统调用就属于第二种. (访管指令)&lt;/p&gt;
&lt;h3&gt;中断和异常&lt;/h3&gt;
&lt;p&gt;中断和异常是操作系统的驱动.&lt;/p&gt;
&lt;p&gt;中断(外中断), 是外部事件,导致硬件的中断:
- I/O 中断
- 时钟中断
- 硬件故障&lt;/p&gt;
&lt;p&gt;异常(内中断), 是由CPU运行的指令而产生的:
- 系统调用
- 页故障
- 保护性异常
- 断点指令(调试程序)
- 其他&lt;/p&gt;
&lt;p&gt;示意图如下:
&lt;img alt="" src="https://github.com/Changy-/Changy-.github.io/blob/master/images/Screenshot%20from%202015-12-26%2010:24:15.png?raw=true" /&gt;&lt;/p&gt;
&lt;p&gt;可以看出,最关键是的如何使用向量表找到中断程序的入口地址.
&lt;img alt="" src="https://github.com/Changy-/Changy-.github.io/blob/master/images/Screenshot%20from%202015-12-26%2010:28:07.png?raw=true" /&gt;&lt;/p&gt;
&lt;p&gt;通过GDT找到段基址,通过IDT找到偏移量,这样就可以知道中断程序的入口地址了.&lt;/p&gt;
&lt;h3&gt;系统调用&lt;/h3&gt;
&lt;p&gt;&lt;img alt="" src="https://github.com/Changy-/Changy-.github.io/blob/master/images/Screenshot%20from%202015-12-26%2010:39:22.png?raw=true" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://github.com/Changy-/Changy-.github.io/blob/master/images/Screenshot%20from%202015-12-26%2010:48:54.png?raw=true" /&gt;&lt;/p&gt;
&lt;p&gt;这是write(1,"hello",7)的汇编代码,可以看到,通过压栈存储所有的变量,然后执行int 0x80 产生系统调用.
最后,举一个linux中系统调用的例子:
&lt;img alt="" src="https://github.com/Changy-/Changy-.github.io/blob/master/images/Screenshot%20from%202015-12-26%2010:52:07.png?raw=true" /&gt;&lt;/p&gt;</summary><category term="system"></category></entry></feed>